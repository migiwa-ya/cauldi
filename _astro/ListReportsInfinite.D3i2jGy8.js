import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.Dy6lLLXr.js";import{I as x,L as b,a as I,d as S,F as y}from"./FetchRepository.BdM0_wA2.js";import"./_slug_.1673099a.rcQGyw0O.js";const A=({pageInfo:i})=>{const[c,p]=s.useState([]),[L,m]=s.useState(1),[r,u]=s.useState(!0),[d,l]=s.useState(i.endCursor),[f,n]=s.useState(!1),g=async()=>{n(!0);try{const h=await fetch("https://cauldi.com/staticql.config.json").then(e=>e.json()),o=await S(h)({repository:new y("https://cauldi.com/")}).from("reports").join("herbs").join("reportGroup").join("process").cursor(d).pageSize(6).orderBy("updatedAt","desc").exec(),j=o.data.map(e=>({key:e.slug,displayName:e.herbs?.map(t=>t.name)?.join("・")+"の"+e.process?.name+"の作り方",images:(e.reportGroup?.combinedHerbs.map(t=>t.slug)??[]).map(t=>({path:`/images/herbs/${t}/thumbnail.webp`,label:t})),link:`/reports/${e.reportGroupSlug}/`,content:"Report:"+e.herbs?.map(t=>t.name),updatedAt:e.updatedAt}));l(o.pageInfo.endCursor),u(o.pageInfo.hasNextPage),p(e=>[...e,...j]),m(e=>e+1)}finally{n(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(x,{items:c,loadMore:g,hasMore:r,ItemComponent:b}),a.jsx(I,{loading:f&&r})]})};export{A as default};
